!function(){"use strict";var e={p:""},t={formSelector:".popup__form",inputSelector:".popup__item",submitButtonSelector:".button_save",inactiveButtonClass:"button_save_disabled",inputErrorClass:"popup__item-invalid",errorClass:"popup__item-error_active"};function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:String(t)}var i=function(){function e(t,n,r,o){var i=o.handleClickImage;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.placeName=t,this.linkUrl=n,this.templateSelector=r,this._handleClickImage=i}var t,n;return t=e,(n=[{key:"_getTemplate",value:function(){var e=document.querySelector(this.templateSelector).content.querySelector(".element").cloneNode(!0);return e.querySelector(".element__title").textContent=this.placeName,e.querySelector(".element__image").src=this.linkUrl,e}},{key:"_setEventListeners",value:function(){var e=this,t=this._cardElement.querySelector(".button_delete"),n=this._cardElement.querySelector(".element__image"),r=this._cardElement.querySelector(".button_like");t.addEventListener("click",(function(){e._cardElement.remove()})),n.addEventListener("click",this._handleClickImage),r.addEventListener("click",(function(){r.classList.toggle("button_like-black")}))}},{key:"generateCard",value:function(){return this._cardElement=this._getTemplate(),this._setEventListeners(),this._cardElement}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function c(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:String(t)}var s=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),c(this,"_checkInputValidity",(function(e,t,n,o){t.validity.valid?r._hideInputError(e,t,n,o):r._showInputError(e,t,t.validationMessage,n,o)})),c(this,"_showInputError",(function(e,t,n,r,o){var i=e.querySelector(".".concat(t.id,"-error"));t.classList.add(r),i.textContent=n,i.classList.add(o)})),c(this,"_hideInputError",(function(e,t,n,r){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n),o.classList.remove(r),o.textContent=""})),c(this,"_toggleButtonState",(function(e,t,n){if(Array.isArray(e)&&r._hasInvalidInput(e))t.classList.add(n),t.disabled=!0;else{if(!t)return;t.classList.remove(n),t.disabled=!1}})),this.selectorsConfig=t,this.formElement=n}var t,n;return t=e,(n=[{key:"_hasInvalidInput",value:function(e){return e.some((function(e){return!e.validity.valid}))}},{key:"enableValidation",value:function(){var e=this;this.formElement.addEventListener("submit",(function(e){e.preventDefault()}));var t=this.formElement.querySelectorAll(this.selectorsConfig.inputSelector),n=Array.from(t),r=this.formElement.querySelector(this.selectorsConfig.submitButtonSelector);this._toggleButtonState(n,r,this.selectorsConfig.inactiveButtonClass),n.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(e.formElement,t,e.selectorsConfig.inputErrorClass,e.selectorsConfig.errorClass),e._toggleButtonState(n,r,e.selectorsConfig.inactiveButtonClass)}))}))}}])&&l(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,y(r.key),r)}}function y(e){var t=function(e,t){if("object"!=f(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==f(t)?t:String(t)}var m=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popupElement=document.querySelector(t),this._popupCloseButton=this._popupElement.querySelector(".button_close"),this._handleEscClose=this._handleEscClose.bind(this),this._popupCloseOverlay=this._popupElement.querySelector(".popup__overlay"),this.setEventListeners()}var t,n;return t=e,(n=[{key:"open",value:function(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"setEventListeners",value:function(){var e=this;this._popupCloseButton.addEventListener("click",(function(){e.close()})),this._popupCloseOverlay.addEventListener("click",(function(){e.close()}))}}])&&p(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function d(e){var t=function(e,t){if("object"!=b(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==b(t)?t:String(t)}function h(e,t,n){return t=S(t),function(e,t){if(t&&("object"===b(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,_()?Reflect.construct(t,n||[],S(e).constructor):t.apply(e,n))}function _(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_=function(){return!!e})()}function g(){return g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=S(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},g.apply(this,arguments)}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}function w(e,t){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},w(e,t)}var E=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=h(this,t,[e]))._popupImage=n._popupElement.querySelector(".popup__image"),n._popupTitle=n._popupElement.querySelector(".popup__title"),n}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(t,e),n=t,(r=[{key:"open",value:function(e,n){this._popupImage.src=e,this._popupImage.alt=n,this._popupTitle.textContent=n,g(S(t.prototype),"open",this).call(this)}}])&&v(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(m);function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,C(r.key),r)}}function C(e){var t=function(e,t){if("object"!=j(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==j(t)?t:String(t)}function O(e,t,n){return t=L(t),function(e,t){if(t&&("object"===j(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,P()?Reflect.construct(t,n||[],L(e).constructor):t.apply(e,n))}function P(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(P=function(){return!!e})()}function q(){return q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=L(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},q.apply(this,arguments)}function L(e){return L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},L(e)}function I(e,t){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},I(e,t)}var T=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=O(this,t,[e]))._submitCallback=n,r}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I(e,t)}(t,e),n=t,(r=[{key:"close",value:function(){this._popupElement.querySelector("form"),q(L(t.prototype),"close",this).call(this)}},{key:"_getInputValues",value:function(){var e={},t=this._popupElement.querySelector("form");return Array.from(t.querySelectorAll("input")).forEach((function(t){e[t.name]=t.value})),e}},{key:"setEventListeners",value:function(){var e=this;q(L(t.prototype),"setEventListeners",this).call(this);var n=this._popupElement.querySelector("form");n.addEventListener("submit",(function(t){t.preventDefault(),e._submitCallback(e._getInputValues()),e.close(),n.reset()}))}}])&&k(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(m);function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,x(r.key),r)}}function x(e){var t=function(e,t){if("object"!=R(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=R(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==R(t)?t:String(t)}var A=function(){function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=r,this._renderer=o,this._container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"addItem",value:function(e){this._container.appendChild(e)}},{key:"clear",value:function(){this._container.innerHTML=""}},{key:"renderItems",value:function(){var e=this;this.clear(),this._items.forEach((function(t){e._renderer(t)}))}}])&&B(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function V(e){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V(e)}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,U(r.key),r)}}function U(e){var t=function(e,t){if("object"!=V(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=V(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==V(t)?t:String(t)}var M=function(){function e(t){var n=t.usernameSelector,r=t.jobSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._username=document.querySelector(n),this._job=document.querySelector(r)}var t,n;return t=e,n=[{key:"getUserInfo",value:function(){return{username:this._username.textContent,job:this._job.textContent}}},{key:"setUserInfo",value:function(e){var t=e.username,n=e.job;this._username.textContent=t,this._job.textContent=n}}],n&&D(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),N=e.p+"images/valle.jpg",G=e.p+"images/Rushmore.jpg",H=e.p+"images/canon.jpg",Y=e.p+"images/tahoe.jpg",z=e.p+"images/ruta.jpg",F=e.p+"images/Roswell.jpg",J=(e.p,e.p,document.querySelector(".button_edit")),K=document.querySelector(".profile__name"),Q=document.querySelector(".profile__job"),W=document.forms.edit,X=W.elements.name,Z=W.elements.job,$=document.querySelector(".button_add"),ee=document.querySelector(".elements"),te=[{name:"Valle de Yosemite",link:N},{name:"Monte Rushmore",link:G},{name:"Gran CaÃ±on",link:H},{name:"Lago Tahoe",link:Y},{name:"Ruta 66",link:z},{name:"Roswell",link:F}],ne=new E(".popup_image"),re=new T(".popup_profile",(function(e){K.textContent=e.name,Q.textContent=e.job,re.close()})),oe=new T(".popup_add",(function(e){var t=new i(e.title,e.url,"#card-template",{handleClickImage:function(){ne.open(e.url,e.title)}});ee.prepend(t.generateCard())}));J.addEventListener("click",(function(){var e=ie.getUserInfo();X.value=e.username,Z.value=e.job,re.open()})),$.addEventListener("click",(function(){oe.open()}));var ie=new M({usernameSelector:".profile__name",jobSelector:".profile__job"}),ue=new A({items:te,renderer:function(e){var t=new i(e.name,e.link,"#card-template",{handleClickImage:function(){ne.open(e.link,e.name)}});ue.addItem(t.generateCard())}},".elements");ue.renderItems(),Array.from(document.querySelectorAll(t.formSelector)).forEach((function(e){new s(t,e).enableValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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b0MsR0FBZSxJQUFJakQsRUFDdkIsQ0FDRUUsTUFBTzJCLEdBQ1AxQixTQUFVLFNBQUNPLEdBQ1QsSUFBTThCLEVBQVUsSUFBSWpJLEVBQUttRyxFQUFLYixLQUFNYSxFQUFLb0IsS0FBTSxpQkFBa0IsQ0FDL0RsSCxpQkFBa0IsV0FDaEJ5SCxHQUFXTSxLQUFLakMsRUFBS29CLEtBQU1wQixFQUFLYixLQUNsQyxJQUVGb0QsR0FBYUMsUUFBUVYsRUFBUUssZUFDL0IsR0FFRixhQUdGSSxHQUFhRSxjQUViL0YsTUFBTVUsS0FBSzNDLFNBQVMwQyxpQkFBaUI3RCxFQUFnQkMsZUFBZStELFNBQ2xFLFNBQUMzQixHQUN1QixJQUFJRCxFQUFjcEMsRUFBaUJxQyxHQUMzQytHLGtCQUNoQixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvc2NyaXB0cy91dGlscy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvc2NyaXB0cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9zY3JpcHRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL3NjcmlwdHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL3NjcmlwdHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL3NjcmlwdHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvc2NyaXB0cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9zY3JpcHRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9zY3JpcHRzL0NvbnN0LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjsiLCJleHBvcnQgZnVuY3Rpb24gcmVtb3ZlQ2FyZChjYXJkRWxlbWVudCkge1xuICBjYXJkRWxlbWVudC5yZW1vdmUoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRvZ2dsZUxpa2UoYnV0dG9uX2xpa2UpIHtcbiAgYnV0dG9uX2xpa2UuY2xhc3NMaXN0LnRvZ2dsZShcImJ1dHRvbl9saWtlLWJsYWNrXCIpO1xufVxuXG5leHBvcnQgY29uc3Qgc2VsZWN0b3JzQ29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLnBvcHVwX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLnBvcHVwX19pdGVtXCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5idXR0b25fc2F2ZVwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImJ1dHRvbl9zYXZlX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faXRlbS1pbnZhbGlkXCIsXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2l0ZW0tZXJyb3JfYWN0aXZlXCIsXG59O1xuIiwiaW1wb3J0IHsgcmVtb3ZlQ2FyZCwgdG9nZ2xlTGlrZSB9IGZyb20gXCIuL3V0aWxzLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IocGxhY2VOYW1lLCBsaW5rVXJsLCB0ZW1wbGF0ZVNlbGVjdG9yLCB7IGhhbmRsZUNsaWNrSW1hZ2UgfSkge1xuICAgIHRoaXMucGxhY2VOYW1lID0gcGxhY2VOYW1lO1xuICAgIHRoaXMubGlua1VybCA9IGxpbmtVcmw7XG4gICAgdGhpcy50ZW1wbGF0ZVNlbGVjdG9yID0gdGVtcGxhdGVTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVDbGlja0ltYWdlID0gaGFuZGxlQ2xpY2tJbWFnZTtcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMudGVtcGxhdGVTZWxlY3RvcikuY29udGVudDtcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRcIikuY2xvbmVOb2RlKHRydWUpO1xuICAgIGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fdGl0bGVcIikudGV4dENvbnRlbnQgPSB0aGlzLnBsYWNlTmFtZTtcbiAgICBjb25zdCBjYXJkSW1hZ2UgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2ltYWdlXCIpO1xuICAgIGNhcmRJbWFnZS5zcmMgPSB0aGlzLmxpbmtVcmw7XG5cbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgY29uc3QgZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5idXR0b25fZGVsZXRlXCIpO1xuICAgIGNvbnN0IGNsaWNrSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2ltYWdlXCIpO1xuICAgIGNvbnN0IGxpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmJ1dHRvbl9saWtlXCIpO1xuXG4gICAgZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICByZW1vdmVDYXJkKHRoaXMuX2NhcmRFbGVtZW50KTtcbiAgICB9KTtcblxuICAgIGNsaWNrSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUNsaWNrSW1hZ2UpO1xuXG4gICAgbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdG9nZ2xlTGlrZShsaWtlQnV0dG9uKTtcbiAgICB9KTtcbiAgfVxuXG4gIGdlbmVyYXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZWxlY3RvcnNDb25maWcsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5zZWxlY3RvcnNDb25maWcgPSBzZWxlY3RvcnNDb25maWc7XG4gICAgdGhpcy5mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eSA9IChcbiAgICBmb3JtRWxlbWVudCxcbiAgICBpbnB1dEVsZW1lbnQsXG4gICAgaW5wdXRFcnJvckNsYXNzLFxuICAgIGVycm9yQ2xhc3NcbiAgKSA9PiB7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKFxuICAgICAgICBmb3JtRWxlbWVudCxcbiAgICAgICAgaW5wdXRFbGVtZW50LFxuICAgICAgICBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UsXG4gICAgICAgIGlucHV0RXJyb3JDbGFzcyxcbiAgICAgICAgZXJyb3JDbGFzc1xuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoXG4gICAgICAgIGZvcm1FbGVtZW50LFxuICAgICAgICBpbnB1dEVsZW1lbnQsXG4gICAgICAgIGlucHV0RXJyb3JDbGFzcyxcbiAgICAgICAgZXJyb3JDbGFzc1xuICAgICAgKTtcbiAgICB9XG4gIH07XG5cbiAgX3Nob3dJbnB1dEVycm9yID0gKFxuICAgIGZvcm1FbGVtZW50LFxuICAgIGlucHV0RWxlbWVudCxcbiAgICBlcnJvck1lc3NhZ2UsXG4gICAgaW5wdXRFcnJvckNsYXNzLFxuICAgIGVycm9yQ2xhc3NcbiAgKSA9PiB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKGlucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKGVycm9yQ2xhc3MpO1xuICB9O1xuXG4gIF9oaWRlSW5wdXRFcnJvciA9IChcbiAgICBmb3JtRWxlbWVudCxcbiAgICBpbnB1dEVsZW1lbnQsXG4gICAgaW5wdXRFcnJvckNsYXNzLFxuICAgIGVycm9yQ2xhc3NcbiAgKSA9PiB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGlucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoZXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgfTtcblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBpbmFjdGl2ZUJ1dHRvbkNsYXNzKSA9PiB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoaW5wdXRMaXN0KSAmJiB0aGlzLl9oYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xuICAgICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XG4gICAgfSBlbHNlIGlmIChidXR0b25FbGVtZW50KSB7XG4gICAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gICAgfSBlbHNlIHJldHVybjtcbiAgfTtcblxuICBfaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkge1xuICAgIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGlucHV0RWxlbWVudHMgPSB0aGlzLmZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXG4gICAgICB0aGlzLnNlbGVjdG9yc0NvbmZpZy5pbnB1dFNlbGVjdG9yXG4gICAgKTtcblxuICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oaW5wdXRFbGVtZW50cyk7XG5cbiAgICBjb25zdCBidXR0b25FbGVtZW50ID0gdGhpcy5mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5zZWxlY3RvcnNDb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoXG4gICAgICBpbnB1dExpc3QsXG4gICAgICBidXR0b25FbGVtZW50LFxuICAgICAgdGhpcy5zZWxlY3RvcnNDb25maWcuaW5hY3RpdmVCdXR0b25DbGFzc1xuICAgICk7XG5cbiAgICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KFxuICAgICAgICAgIHRoaXMuZm9ybUVsZW1lbnQsXG4gICAgICAgICAgaW5wdXRFbGVtZW50LFxuICAgICAgICAgIHRoaXMuc2VsZWN0b3JzQ29uZmlnLmlucHV0RXJyb3JDbGFzcyxcbiAgICAgICAgICB0aGlzLnNlbGVjdG9yc0NvbmZpZy5lcnJvckNsYXNzXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKFxuICAgICAgICAgIGlucHV0TGlzdCxcbiAgICAgICAgICBidXR0b25FbGVtZW50LFxuICAgICAgICAgIHRoaXMuc2VsZWN0b3JzQ29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3NcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuXG4gICAgdGhpcy5fcG9wdXBDbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmJ1dHRvbl9jbG9zZVwiKTtcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fcG9wdXBDbG9zZU92ZXJsYXkgPVxuICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX292ZXJsYXlcIik7XG4gICAgdGhpcy5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UoZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICAgIHRoaXMuX3BvcHVwQ2xvc2VPdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2VcIik7XG4gICAgdGhpcy5fcG9wdXBUaXRsZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX190aXRsZVwiKTtcbiAgfVxuXG4gIG9wZW4obGlua1VybCwgcGxhY2VOYW1lKSB7XG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBsaW5rVXJsO1xuICAgIHRoaXMuX3BvcHVwSW1hZ2UuYWx0ID0gcGxhY2VOYW1lO1xuICAgIHRoaXMuX3BvcHVwVGl0bGUudGV4dENvbnRlbnQgPSBwbGFjZU5hbWU7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgY2FsbGJhY2spIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9zdWJtaXRDYWxsYmFjayA9IGNhbGxiYWNrO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgY29uc3QgZm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiZm9ybVwiKTtcbiAgICBzdXBlci5jbG9zZSgpO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XG4gICAgY29uc3QgZm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiZm9ybVwiKTtcbiAgICBBcnJheS5mcm9tKGZvcm0ucXVlcnlTZWxlY3RvckFsbChcImlucHV0XCIpKS5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIGNvbnN0IGZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcImZvcm1cIik7XG4gICAgZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX3N1Ym1pdENhbGxiYWNrKHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgZm9ybS5yZXNldCgpO1xuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICBhZGRJdGVtKGNhcmRFbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZENoaWxkKGNhcmRFbGVtZW50KTtcbiAgfVxuXG4gIGNsZWFyKCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5pbm5lckhUTUwgPSBcIlwiO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgdGhpcy5jbGVhcigpO1xuXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyB1c2VybmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fdXNlcm5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX2pvYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHVzZXJuYW1lOiB0aGlzLl91c2VybmFtZS50ZXh0Q29udGVudCxcbiAgICAgIGpvYjogdGhpcy5fam9iLnRleHRDb250ZW50LFxuICAgIH07XG4gIH1cblxuICBzZXRVc2VySW5mbyh7IHVzZXJuYW1lLCBqb2IgfSkge1xuICAgIHRoaXMuX3VzZXJuYW1lLnRleHRDb250ZW50ID0gdXNlcm5hbWU7XG4gICAgdGhpcy5fam9iLnRleHRDb250ZW50ID0gam9iO1xuICB9XG59XG4iLCJleHBvcnQgY29uc3QgYnV0dG9uRWRpdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYnV0dG9uX2VkaXRcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUpvYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fam9iXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZm9ybXMuZWRpdDtcbmV4cG9ydCBjb25zdCBpbnB1dE5hbWUgPSBwcm9maWxlRm9ybS5lbGVtZW50cy5uYW1lO1xuZXhwb3J0IGNvbnN0IGpvYiA9IHByb2ZpbGVGb3JtLmVsZW1lbnRzLmpvYjtcbmV4cG9ydCBjb25zdCBidXR0b25BZGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmJ1dHRvbl9hZGRcIik7XG5leHBvcnQgY29uc3QgZWxlbWVudHNTZWN0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c1wiKTtcbmV4cG9ydCBjb25zdCBwb3B1cFByb2ZpbGVTZWxlY3RvciA9IFwiLnBvcHVwX3Byb2ZpbGVcIjtcbmV4cG9ydCBjb25zdCBwb3B1cEFkZFNlbGVjdG9yID0gXCIucG9wdXBfYWRkXCI7XG5leHBvcnQgY29uc3QgcG9wdXBJbWFnZVNlbGVjdG9yID0gXCIucG9wdXBfaW1hZ2VcIjtcblxuaW1wb3J0IHZhbGxlIGZyb20gXCIuLi9pbWFnZXMvdmFsbGUuanBnXCI7XG5pbXBvcnQgUnVzaG1vcmUgZnJvbSBcIi4uL2ltYWdlcy9SdXNobW9yZS5qcGdcIjtcbmltcG9ydCBjYW5vbiBmcm9tIFwiLi4vaW1hZ2VzL2Nhbm9uLmpwZ1wiO1xuaW1wb3J0IFRhaG9lIGZyb20gXCIuLi9pbWFnZXMvdGFob2UuanBnXCI7XG5pbXBvcnQgUnV0YSBmcm9tIFwiLi4vaW1hZ2VzL3J1dGEuanBnXCI7XG5pbXBvcnQgUm9zd2VsbCBmcm9tIFwiLi4vaW1hZ2VzL1Jvc3dlbGwuanBnXCI7XG5pbXBvcnQgYXZhdGFyIGZyb20gXCIuLi9pbWFnZXMvQXZhdGFyLnBuZ1wiO1xuaW1wb3J0IGxvZ28gZnJvbSBcIi4uL2ltYWdlcy9sb2dvLnN2Z1wiO1xuXG5leHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJWYWxsZSBkZSBZb3NlbWl0ZVwiLFxuICAgIGxpbms6IHZhbGxlLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJNb250ZSBSdXNobW9yZVwiLFxuICAgIGxpbms6IFJ1c2htb3JlLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJHcmFuIENhw7FvblwiLFxuICAgIGxpbms6IGNhbm9uLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWdvIFRhaG9lXCIsXG4gICAgbGluazogVGFob2UsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlJ1dGEgNjZcIixcbiAgICBsaW5rOiBSdXRhLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJSb3N3ZWxsXCIsXG4gICAgbGluazogUm9zd2VsbCxcbiAgfSxcbl07XG4iLCJpbXBvcnQgQ2FyZCBmcm9tIFwiLi9zY3JpcHRzL0NhcmQuanNcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuL3NjcmlwdHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IHsgc2VsZWN0b3JzQ29uZmlnIH0gZnJvbSBcIi4vc2NyaXB0cy91dGlscy5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuL3NjcmlwdHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuL3NjcmlwdHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4vc2NyaXB0cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4vc2NyaXB0cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IFwiLi9wYWdlcy9pbmRleC5jc3NcIjtcbmltcG9ydCB7XG4gIGJ1dHRvbkVkaXQsXG4gIHByb2ZpbGVOYW1lLFxuICBwcm9maWxlSm9iLFxuICBpbnB1dE5hbWUsXG4gIGpvYixcbiAgYnV0dG9uQWRkLFxuICBlbGVtZW50c1NlY3Rpb24sXG4gIHBvcHVwUHJvZmlsZVNlbGVjdG9yLFxuICBwb3B1cEFkZFNlbGVjdG9yLFxuICBwb3B1cEltYWdlU2VsZWN0b3IsXG4gIGluaXRpYWxDYXJkcyxcbn0gZnJvbSBcIi4vc2NyaXB0cy9Db25zdC5qc1wiO1xuXG5jb25zdCBwb3B1cEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKHBvcHVwSW1hZ2VTZWxlY3Rvcik7XG5cbmNvbnN0IHBvcHVwUHJvZmlsZSA9IG5ldyBQb3B1cFdpdGhGb3JtKHBvcHVwUHJvZmlsZVNlbGVjdG9yLCAoaW5wdXRWYWx1ZXMpID0+IHtcbiAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBpbnB1dFZhbHVlcy5uYW1lO1xuICBwcm9maWxlSm9iLnRleHRDb250ZW50ID0gaW5wdXRWYWx1ZXMuam9iO1xuICBwb3B1cFByb2ZpbGUuY2xvc2UoKTtcbn0pO1xuXG5jb25zdCBwb3B1cEFkZEJ1dHRvbiA9IG5ldyBQb3B1cFdpdGhGb3JtKHBvcHVwQWRkU2VsZWN0b3IsIChpbnB1dFZhbHVlcykgPT4ge1xuICBjb25zdCBuZXdDYXJkID0gbmV3IENhcmQoXG4gICAgaW5wdXRWYWx1ZXMudGl0bGUsXG4gICAgaW5wdXRWYWx1ZXMudXJsLFxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgICB7XG4gICAgICBoYW5kbGVDbGlja0ltYWdlOiAoKSA9PiB7XG4gICAgICAgIHBvcHVwSW1hZ2Uub3BlbihpbnB1dFZhbHVlcy51cmwsIGlucHV0VmFsdWVzLnRpdGxlKTtcbiAgICAgIH0sXG4gICAgfVxuICApO1xuICBlbGVtZW50c1NlY3Rpb24ucHJlcGVuZChuZXdDYXJkLmdlbmVyYXRlQ2FyZCgpKTtcbn0pO1xuXG5idXR0b25FZGl0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgaW5wdXROYW1lLnZhbHVlID0gdXNlckRhdGEudXNlcm5hbWU7XG4gIGpvYi52YWx1ZSA9IHVzZXJEYXRhLmpvYjtcbiAgcG9wdXBQcm9maWxlLm9wZW4oKTtcbn0pO1xuXG5idXR0b25BZGQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgcG9wdXBBZGRCdXR0b24ub3BlbigpO1xufSk7XG5cbmV4cG9ydCBjb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIHVzZXJuYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX25hbWVcIixcbiAgam9iU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2pvYlwiLFxufSk7XG5cbmNvbnN0IHNlY3Rpb25DYXJkcyA9IG5ldyBTZWN0aW9uKFxuICB7XG4gICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcbiAgICByZW5kZXJlcjogKGl0ZW0pID0+IHtcbiAgICAgIGNvbnN0IG5ld0NhcmQgPSBuZXcgQ2FyZChpdGVtLm5hbWUsIGl0ZW0ubGluaywgXCIjY2FyZC10ZW1wbGF0ZVwiLCB7XG4gICAgICAgIGhhbmRsZUNsaWNrSW1hZ2U6ICgpID0+IHtcbiAgICAgICAgICBwb3B1cEltYWdlLm9wZW4oaXRlbS5saW5rLCBpdGVtLm5hbWUpO1xuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgICBzZWN0aW9uQ2FyZHMuYWRkSXRlbShuZXdDYXJkLmdlbmVyYXRlQ2FyZCgpKTtcbiAgICB9LFxuICB9LFxuICBcIi5lbGVtZW50c1wiXG4pO1xuXG5zZWN0aW9uQ2FyZHMucmVuZGVySXRlbXMoKTtcblxuQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yc0NvbmZpZy5mb3JtU2VsZWN0b3IpKS5mb3JFYWNoKFxuICAoZm9ybUVsZW1lbnQpID0+IHtcbiAgICBjb25zdCBmb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2VsZWN0b3JzQ29uZmlnLCBmb3JtRWxlbWVudCk7XG4gICAgZm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG4gIH1cbik7XG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsInNlbGVjdG9yc0NvbmZpZyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiQ2FyZCIsInBsYWNlTmFtZSIsImxpbmtVcmwiLCJ0ZW1wbGF0ZVNlbGVjdG9yIiwiX3JlZiIsImhhbmRsZUNsaWNrSW1hZ2UiLCJfY2xhc3NDYWxsQ2hlY2siLCJ0aGlzIiwiX2hhbmRsZUNsaWNrSW1hZ2UiLCJrZXkiLCJ2YWx1ZSIsImNhcmRFbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsInRleHRDb250ZW50Iiwic3JjIiwiX3RoaXMiLCJkZWxldGVCdXR0b24iLCJfY2FyZEVsZW1lbnQiLCJjbGlja0ltYWdlIiwibGlrZUJ1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmUiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJfZ2V0VGVtcGxhdGUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJGb3JtVmFsaWRhdG9yIiwiZm9ybUVsZW1lbnQiLCJfZGVmaW5lUHJvcGVydHkiLCJpbnB1dEVsZW1lbnQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJjb25jYXQiLCJpZCIsImFkZCIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJBcnJheSIsImlzQXJyYXkiLCJfaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZWQiLCJzb21lIiwiX3RoaXMyIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsImlucHV0RWxlbWVudHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZnJvbSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImZvckVhY2giLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9wb3B1cENsb3NlQnV0dG9uIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIl9wb3B1cENsb3NlT3ZlcmxheSIsInNldEV2ZW50TGlzdGVuZXJzIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImNsb3NlIiwiUG9wdXBXaXRoSW1hZ2UiLCJfUG9wdXAiLCJfY2FsbFN1cGVyIiwiX3BvcHVwSW1hZ2UiLCJfcG9wdXBUaXRsZSIsIl9pbmhlcml0cyIsImFsdCIsIl9nZXQiLCJfZ2V0UHJvdG90eXBlT2YiLCJwcm90b3R5cGUiLCJjYWxsIiwiUG9wdXBXaXRoRm9ybSIsImNhbGxiYWNrIiwiX3N1Ym1pdENhbGxiYWNrIiwiaW5wdXRWYWx1ZXMiLCJmb3JtIiwiaW5wdXQiLCJuYW1lIiwiX2dldElucHV0VmFsdWVzIiwicmVzZXQiLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImFwcGVuZENoaWxkIiwiaW5uZXJIVE1MIiwiY2xlYXIiLCJpdGVtIiwiVXNlckluZm8iLCJ1c2VybmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJfdXNlcm5hbWUiLCJfam9iIiwidXNlcm5hbWUiLCJqb2IiLCJfcmVmMiIsImJ1dHRvbkVkaXQiLCJwcm9maWxlTmFtZSIsInByb2ZpbGVKb2IiLCJwcm9maWxlRm9ybSIsImZvcm1zIiwiZWRpdCIsImlucHV0TmFtZSIsImVsZW1lbnRzIiwiYnV0dG9uQWRkIiwiZWxlbWVudHNTZWN0aW9uIiwiaW5pdGlhbENhcmRzIiwibGluayIsInZhbGxlIiwiUnVzaG1vcmUiLCJjYW5vbiIsIlRhaG9lIiwiUnV0YSIsIlJvc3dlbGwiLCJwb3B1cEltYWdlIiwicG9wdXBQcm9maWxlIiwicG9wdXBBZGRCdXR0b24iLCJuZXdDYXJkIiwidGl0bGUiLCJ1cmwiLCJvcGVuIiwicHJlcGVuZCIsImdlbmVyYXRlQ2FyZCIsInVzZXJEYXRhIiwidXNlckluZm8iLCJnZXRVc2VySW5mbyIsInNlY3Rpb25DYXJkcyIsImFkZEl0ZW0iLCJyZW5kZXJJdGVtcyIsImVuYWJsZVZhbGlkYXRpb24iXSwic291cmNlUm9vdCI6IiJ9