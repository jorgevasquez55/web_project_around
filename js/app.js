!function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,n(o.key),o)}}function n(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:String(n)}var r=function(){function e(t,n,r,o){var i=r.handleCardClick,u=r.handlerDeleteCard,a=r.handlerAddLike,c=r.handlerRemoveLike;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t.name,this._link=t.link,this._likes=t.likes||0,this._id=t._id,this._owner=t.owner,this._currentUser=o,this._templateSelector=n,this._handleCardClick=i,this._handlerDeleteCard=u,this._handlerAddLike=a,this._handlerRemoveLike=c}var n,r;return n=e,(r=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}},{key:"_setEventListeners",value:function(e){var t=this,n=e.querySelector(".element__trash"),r=e.querySelector(".element__button_liked"),o=e.querySelector(".element__image");n.addEventListener("click",(function(){t._handlerDeleteCard(e,t._id)})),r.addEventListener("click",(function(){t._hasLikeOwner()?t._handlerRemoveLike(t._id).then((function(n){t._likes=n.likes,e.querySelector(".element__likes-count").textContent=t._likes.length,r.classList.add("element__button_liked")})):t._handlerAddLike(t._id).then((function(n){t._likes=n.likes,e.querySelector(".element__likes-count").textContent=t._likes.length,r.classList.remove("element__button_liked")}))})),o.addEventListener("click",(function(){t._handleCardClick(t._name,t._link)}))}},{key:"_hasLikeOwner",value:function(){var e=this;return this._likes.some((function(t){return t._id===e._currentUser._id}))}},{key:"_isMe",value:function(){return this._owner._id===this._currentUser._id}},{key:"generateCard",value:function(){return this._element=this._getTemplate(),this._element.querySelector(".element__image").src=this._link,this._element.querySelector(".element__image").alt=this._name,this._element.querySelector(".element__place").textContent=this._name,this._element.querySelector(".element__likes-count").textContent=this._likes.length,this._setEventListeners(this._element),this._hasLikeOwner()&&this._element.querySelector(".element__button_liked").classList.remove("element__button_liked"),this._isMe()||this._element.querySelector(".element__trash").remove(),this._element}}])&&t(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:String(t)}var a=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._settings=t,this._formElement=n}var t,n;return t=e,(n=[{key:"_showInputError",value:function(e,t){var n=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.add(this._settings.inputErrorClass),n.textContent=t,n.classList.add(this._settings.errorClass)}},{key:"_hideInputError",value:function(e){var t=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(this._settings.inputErrorClass),t.textContent="",t.classList.remove(this._settings.errorClass)}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_toggleButtonState",value:function(){var e=this._inputList.every((function(e){return e.validity.valid})),t=this._inputList.some((function(e){return""!==e.value.trim()})),n=this._formElement.querySelector(this._settings.submitButtonSelector);e&&t?(n.classList.remove(this._settings.inactiveButtonClass),n.disabled=!1):(n.classList.add(this._settings.inactiveButtonClass),n.disabled=!0)}},{key:"_setEventListeners",value:function(){var e=this;this._inputList=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),this._submitButton=this._formElement.querySelector(this._settings.submitButtonSelector),this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleButtonState()}))})),this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._toggleButtonState()}},{key:"enableValidation",value:function(){this._setEventListeners()}}])&&i(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=c(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:String(t)}var f=function(){function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.items=r,this.renderer=o,this.container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"rendererItems",value:function(){var e=this;this.items.forEach((function(t){e.renderer(t)}))}},{key:"addItem",value:function(e){this.container.appendChild(e)}}])&&l(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,m(r.key),r)}}function m(e){var t=function(e,t){if("object"!=p(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==p(t)?t:String(t)}var d=function(){function e(t){var n,r,o,i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,o=function(e){"Escape"===e.key&&i.close()},(r=m(r="_handleEscClose"))in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,this._popup=document.querySelector(t)}var t,n;return t=e,(n=[{key:"open",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"setEventListeners",value:function(){var e=this;this._popup.addEventListener("click",(function(t){(t.target.classList.contains("popup")||t.target.classList.contains("popup__container-close-button-image"))&&e.close()}))}}])&&y(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}function b(e){var t=function(e,t){if("object"!=v(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=v(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==v(t)?t:String(t)}function _(e,t,n){return t=k(t),function(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,g()?Reflect.construct(t,n||[],k(e).constructor):t.apply(e,n))}function g(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(g=function(){return!!e})()}function S(){return S="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=k(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},S.apply(this,arguments)}function k(e){return k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},k(e)}function E(e,t){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},E(e,t)}var w=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=_(this,t,[e]))._popupImage=n._popup.querySelector(".image-popup__image"),n._popupTitle=n._popup.querySelector(".image-popup__title"),n}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(t,e),n=t,(r=[{key:"open",value:function(e,n){S(k(t.prototype),"open",this).call(this),this._popupImage.src=e,this._popupImage.alt=n,this._popupTitle.textContent=n,this._popup.style.display="block"}},{key:"close",value:function(){S(k(t.prototype),"close",this).call(this),this._popup.style.display="none"}},{key:"setEventListeners",value:function(){var e=this;S(k(t.prototype),"setEventListeners",this).call(this),this._popup.addEventListener("click",(function(t){(t.target.classList.contains("image-popup")||t.target.classList.contains("image-popup__content")||t.target.classList.contains("image-popup__close-button-icon"))&&e.close()}))}}])&&h(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(d);function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,L(r.key),r)}}function L(e){var t=function(e,t){if("object"!=j(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==j(t)?t:String(t)}function P(e,t,n){return t=I(t),function(e,t){if(t&&("object"===j(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,C()?Reflect.construct(t,n||[],I(e).constructor):t.apply(e,n))}function C(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(C=function(){return!!e})()}function q(){return q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=I(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},q.apply(this,arguments)}function I(e){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},I(e)}function T(e,t){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},T(e,t)}var B=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=P(this,t,[e]))._submitCallback=n,r._form=r._popup.querySelector(".form"),r._inputList=r._form.querySelectorAll(".form__input"),r}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}(t,e),n=t,(r=[{key:"_getInputValues",value:function(){var e={};return this._inputList.forEach((function(t){e[t.name]=t.value})),e}},{key:"setEventListeners",value:function(){var e=this;q(I(t.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(t){t.preventDefault(),e._form.querySelector(".form__submit").textContent="Guardando...",e._submitCallback(e._getInputValues()).then((function(){e._form.querySelector(".form__submit").textContent="Guardar"})).finally((function(){t.target.reset(),e.close()}))}))}},{key:"close",value:function(){q(I(t.prototype),"close",this).call(this),this._form.reset()}}])&&O(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(d);function U(e){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U(e)}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,x(r.key),r)}}function x(e){var t=function(e,t){if("object"!=U(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=U(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==U(t)?t:String(t)}var A=function(){function e(t){var n=t.nameSelector,r=t.roleSelector,o=t.avatarSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._nameElement=document.querySelector(n),this._roleElement=document.querySelector(r),this._avatarElement=document.querySelector(o)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this._nameElement.textContent,role:this._roleElement.textContent}}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.about;this._nameElement.textContent=t,this._roleElement.textContent=n}},{key:"setUserAvatar",value:function(e){this._avatarElement.src=e}}])&&R(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,M(r.key),r)}}function M(e){var t=function(e,t){if("object"!=D(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==D(t)?t:String(t)}function N(e,t,n){return t=H(t),function(e,t){if(t&&("object"===D(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,J()?Reflect.construct(t,n||[],H(e).constructor):t.apply(e,n))}function J(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(J=function(){return!!e})()}function G(){return G="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=H(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},G.apply(this,arguments)}function H(e){return H=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},H(e)}function z(e,t){return z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},z(e,t)}var F=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=N(this,t,[e]))._confirmCallback=n,r._yesButton=r._popup.querySelector(".popup__confirm-button_yes"),r._noButton=r._popup.querySelector(".popup__confirm-button_no"),r}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z(e,t)}(t,e),n=t,(r=[{key:"setEventListeners",value:function(){var e=this;G(H(t.prototype),"setEventListeners",this).call(this),this._yesButton.addEventListener("click",(function(){e._confirmCallback(),e.close()})),this._noButton.addEventListener("click",(function(){e.close()}))}}])&&V(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(d);function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,W(r.key),r)}}function W(e){var t=function(e,t){if("object"!=K(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=K(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==K(t)?t:String(t)}var X=new(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl=t.baseUrl,this._headers=t.headers}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"addCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"addLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"removeLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"updateUserInfo",value:function(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"updateAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}}])&&Q(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}())({baseUrl:"https://around.nomoreparties.co/v1/web_es_11",headers:{authorization:"d9cef837-d29b-426a-8d58-8635ddff4d3f","Content-Type":"application/json"}}),Y=(document.getElementById("popup"),document.querySelector(".profile__name")),Z=document.querySelector(".profile__role"),$=document.getElementById("editButton"),ee=document.getElementById("addButton"),te=(document.getElementById("closeEditButton"),document.getElementById("saveEditButton"),document.getElementById("closeCardButton"),document.getElementById("saveCardButton"),document.querySelector(".elements")),ne=document.querySelector(".profile__avatar"),re={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__submit",inactiveButtonClass:"form__submit_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"},oe=null,ie=null;function ue(e,t){me.open(t,e)}X.getUserInfo().then((function(e){return ie=e,he.setUserInfo(e),he.setUserAvatar(e.avatar),X.getInitialCards()})).then((function(e){(oe=new f({items:e,renderer:function(e){var t=new r(e,".template",{handleCardClick:ue,handlerDeleteCard:function(e,t){be={cardElement:e,_id:t},_e.open()},handlerAddLike:function(e){return X.addLike(e)},handlerRemoveLike:function(e){return X.removeLike(e)}},ie),n=t.generateCard();oe.addItem(n)}},".elements")).rendererItems()}));var ae=document.getElementById("form-profile"),ce=document.querySelector(".popup_tarjeta form"),le=document.querySelector(".popup_avatar form"),se=new a(re,ae),fe=new a(re,ce),pe=new a(re,le);se.enableValidation(),fe.enableValidation(),pe.enableValidation();var ye=new d(".popup");ye.setEventListeners(),ye.open(),ye.close();var me=new w(".image-popup");me.setEventListeners();var de=new B(".popup",(function(e){var t=e.name,n=e.about;return X.updateUserInfo({name:t,about:n}).then((function(e){he.setUserInfo({name:t,about:n})}))}));de.setEventListeners();var ve=new B(".popup_tarjeta",(function(e){var t=e.title,n=e.url;return X.addCard({name:t,link:n}).then((function(e){var t=new r(e,".template",{handleCardClick:ue,handlerDeleteCard:function(e,t){be={cardElement:e,_id:t},_e.open()},handlerAddLike:function(e){return X.addLike(e)},handlerRemoveLike:function(e){return X.removeLike(e)}},ie).generateCard();te.prepend(t)}))}));ve.setEventListeners();var he=new A({nameSelector:".profile__name",roleSelector:".profile__role",avatarSelector:".profile__avatar-image"});ee.addEventListener("click",(function(){titleInput.value="",urlInput.value="",ve.open()})),$.addEventListener("click",(function(){nameInput.value=Y.textContent,aboutMeInput.value=Z.textContent,de.open()}));var be=null,_e=new F("#confirmPopup",(function(){be&&X.deleteCard(be._id).then((function(){be.cardElement.remove(),console.log("Tarjeta eliminada")}))}));_e.setEventListeners(),document.querySelectorAll(".element__trash").forEach((function(e){e.addEventListener("click",(function(){_e.open()}))}));var ge=new B(".popup_avatar",(function(e){var t=e.avatar;return X.updateAvatar({avatar:t}).then((function(e){he.setUserAvatar(e.avatar)}))}));ge.setEventListeners(),ne.addEventListener("click",(function(){ge.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFNd0MsR0FBYyxJQUFJaEcsRUFBYyxpQkFBaUIsU0FBQWlHLEdBQWdCLElBQWI5RSxFQUFNOEUsRUFBTjlFLE9BQ3hELE9BQU9zQyxFQUFJeUMsYUFBYSxDQUFFL0UsT0FBQUEsSUFBVXRHLE1BQUssU0FBQ3RDLEdBQ3hDcUwsR0FBU0UsY0FBY3ZMLEVBQUs0SSxPQUM5QixHQUNGLElBRUE2RSxHQUFZaEIsb0JBRVo5QixHQUFXdkksaUJBQWlCLFNBQVMsV0FDbkNxTCxHQUFZeEMsTUFDZCxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoXG4gICAgZGF0YSxcbiAgICB0ZW1wbGF0ZVNlbGVjdG9yLFxuICAgIHsgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVyRGVsZXRlQ2FyZCwgaGFuZGxlckFkZExpa2UsIGhhbmRsZXJSZW1vdmVMaWtlIH0sXG4gICAgY3VycmVudFVzZXJcbiAgKSB7XG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcyB8fCAwO1xuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XG4gICAgdGhpcy5fb3duZXIgPSBkYXRhLm93bmVyO1xuICAgIHRoaXMuX2N1cnJlbnRVc2VyID0gY3VycmVudFVzZXI7XG4gICAgdGhpcy5fdGVtcGxhdGVTZWxlY3RvciA9IHRlbXBsYXRlU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2hhbmRsZXJEZWxldGVDYXJkID0gaGFuZGxlckRlbGV0ZUNhcmQ7XG4gICAgdGhpcy5faGFuZGxlckFkZExpa2UgPSBoYW5kbGVyQWRkTGlrZTtcbiAgICB0aGlzLl9oYW5kbGVyUmVtb3ZlTGlrZSA9IGhhbmRsZXJSZW1vdmVMaWtlO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIGNvbnN0IHRlbXBsYXRlID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgcmV0dXJuIHRlbXBsYXRlO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKGNhcmRFbGVtZW50KSB7XG4gICAgY29uc3QgdHJhc2hJY29uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X190cmFzaFwiKTtcbiAgICBjb25zdCBsaWtlQnV0dG9uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19idXR0b25fbGlrZWRcIik7XG4gICAgY29uc3QgaW1hZ2VOb2RlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19pbWFnZVwiKTtcblxuICAgIHRyYXNoSWNvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlckRlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIHRoaXMuX2lkKTtcbiAgICB9KTtcbiAgICBsaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5faGFzTGlrZU93bmVyKCkpIHtcbiAgICAgICAgdGhpcy5faGFuZGxlclJlbW92ZUxpa2UodGhpcy5faWQpLnRoZW4oKGNhcmQpID0+IHtcbiAgICAgICAgICB0aGlzLl9saWtlcyA9IGNhcmQubGlrZXM7XG4gICAgICAgICAgY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19saWtlcy1jb3VudFwiKS50ZXh0Q29udGVudCA9XG4gICAgICAgICAgICB0aGlzLl9saWtlcy5sZW5ndGg7XG4gICAgICAgICAgbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiZWxlbWVudF9fYnV0dG9uX2xpa2VkXCIpO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX2hhbmRsZXJBZGRMaWtlKHRoaXMuX2lkKS50aGVuKChjYXJkKSA9PiB7XG4gICAgICAgICAgdGhpcy5fbGlrZXMgPSBjYXJkLmxpa2VzO1xuICAgICAgICAgIGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fbGlrZXMtY291bnRcIikudGV4dENvbnRlbnQgPVxuICAgICAgICAgICAgdGhpcy5fbGlrZXMubGVuZ3RoO1xuICAgICAgICAgIGxpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImVsZW1lbnRfX2J1dHRvbl9saWtlZFwiKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cblxuICAgIH0pO1xuICAgIGltYWdlTm9kZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspO1xuICAgIH0pO1xuICB9XG5cbiAgX2hhc0xpa2VPd25lcigpIHtcbiAgICByZXR1cm4gdGhpcy5fbGlrZXMuc29tZSgobGlrZSkgPT4gbGlrZS5faWQgPT09IHRoaXMuX2N1cnJlbnRVc2VyLl9pZCk7XG4gIH1cblxuICBfaXNNZSgpIHtcbiAgICByZXR1cm4gdGhpcy5fb3duZXIuX2lkID09PSB0aGlzLl9jdXJyZW50VXNlci5faWQ7XG4gIH1cblxuICBnZW5lcmF0ZUNhcmQoKSB7XG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2ltYWdlXCIpLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2ltYWdlXCIpLmFsdCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX3BsYWNlXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fbGlrZXMtY291bnRcIikudGV4dENvbnRlbnQgPVxuICAgICAgdGhpcy5fbGlrZXMubGVuZ3RoO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKHRoaXMuX2VsZW1lbnQpO1xuICAgIGlmICh0aGlzLl9oYXNMaWtlT3duZXIoKSkge1xuICAgICAgdGhpcy5fZWxlbWVudFxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19idXR0b25fbGlrZWRcIilcbiAgICAgICAgLmNsYXNzTGlzdC5yZW1vdmUoXCJlbGVtZW50X19idXR0b25fbGlrZWRcIik7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLl9pc01lKCkpIHtcbiAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X190cmFzaFwiKS5yZW1vdmUoKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGNvbnN0IGlzRm9ybVZhbGlkID0gdGhpcy5faW5wdXRMaXN0LmV2ZXJ5KFxuICAgICAgKGlucHV0RWxlbWVudCkgPT4gaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkXG4gICAgKTtcblxuICAgIGNvbnN0IGlzQW55RmllbGRGaWxsZWQgPSB0aGlzLl9pbnB1dExpc3Quc29tZShcbiAgICAgIChpbnB1dEVsZW1lbnQpID0+IGlucHV0RWxlbWVudC52YWx1ZS50cmltKCkgIT09IFwiXCJcbiAgICApO1xuXG4gICAgY29uc3Qgc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIHRoaXMuX3NldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yXG4gICAgKTtcblxuICAgIGlmIChpc0Zvcm1WYWxpZCAmJiBpc0FueUZpZWxkRmlsbGVkKSB7XG4gICAgICBzdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHN1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHN1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX3NldHRpbmdzLmlucHV0U2VsZWN0b3IpXG4gICAgKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5pdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLmNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICB9XG5cbiAgcmVuZGVyZXJJdGVtcygpIHtcbiAgICB0aGlzLml0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMucmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmRDaGlsZChlbGVtZW50KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xuICAgICAgaWYgKFxuICAgICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBcIikgfHxcbiAgICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX19jb250YWluZXItY2xvc2UtYnV0dG9uLWltYWdlXCIpXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2ZW50KSA9PiB7XG4gICAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLmltYWdlLXBvcHVwX19pbWFnZVwiKTtcbiAgICB0aGlzLl9wb3B1cFRpdGxlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5pbWFnZS1wb3B1cF9fdGl0bGVcIik7XG4gIH1cblxuICBvcGVuKGltYWdlU3JjLCBpbWFnZUFsdCkge1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgICB0aGlzLl9wb3B1cEltYWdlLnNyYyA9IGltYWdlU3JjO1xuICAgIHRoaXMuX3BvcHVwSW1hZ2UuYWx0ID0gaW1hZ2VBbHQ7XG4gICAgdGhpcy5fcG9wdXBUaXRsZS50ZXh0Q29udGVudCA9IGltYWdlQWx0O1xuICAgIHRoaXMuX3BvcHVwLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX3BvcHVwLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xuICAgICAgaWYgKFxuICAgICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiaW1hZ2UtcG9wdXBcIikgfHxcbiAgICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImltYWdlLXBvcHVwX19jb250ZW50XCIpIHx8XG4gICAgICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJpbWFnZS1wb3B1cF9fY2xvc2UtYnV0dG9uLWljb25cIilcbiAgICAgICkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvciwgc3VibWl0Q2FsbGJhY2spIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9zdWJtaXRDYWxsYmFjayA9IHN1Ym1pdENhbGxiYWNrO1xuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLmZvcm1fX2lucHV0XCIpO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGZvcm1WYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGZvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gZm9ybVZhbHVlcztcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcIi5mb3JtX19zdWJtaXRcIikudGV4dENvbnRlbnQgPSBcIkd1YXJkYW5kby4uLlwiO1xuICAgICAgdGhpcy5fc3VibWl0Q2FsbGJhY2sodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSlcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcIi5mb3JtX19zdWJtaXRcIikudGV4dENvbnRlbnQgPSBcIkd1YXJkYXJcIjtcbiAgICAgICAgfSlcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgIGV2ZW50LnRhcmdldC5yZXNldCgpO1xuICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3Rvciwgcm9sZVNlbGVjdG9yLCBhdmF0YXJTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fcm9sZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHJvbGVTZWxlY3Rvcik7XG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgcm9sZTogdGhpcy5fcm9sZUVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy5fcm9sZUVsZW1lbnQudGV4dENvbnRlbnQgPSBhYm91dDtcbiAgfVxuXG4gIHNldFVzZXJBdmF0YXIoYXZhdGFyKSB7XG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMgPSBhdmF0YXI7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGNvbmZpcm1DYWxsYmFjaykge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2NvbmZpcm1DYWxsYmFjayA9IGNvbmZpcm1DYWxsYmFjazsgLy8gRnVuY2nDs24gYSBlamVjdXRhciBwYXJhIGVsaW1pbmFyIGxhIHRhcmpldGFcbiAgICB0aGlzLl95ZXNCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jb25maXJtLWJ1dHRvbl95ZXNcIik7XG4gICAgdGhpcy5fbm9CdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jb25maXJtLWJ1dHRvbl9ub1wiKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgLy8gQWdyZWdhIGVsIGV2ZW50byBjbGljayBhbCBib3TDs24gJ1PDrScgcGFyYSBlamVjdXRhciBsYSBmdW5jacOzbiBkZSBjb25maXJtYWNpw7NuXG4gICAgdGhpcy5feWVzQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9jb25maXJtQ2FsbGJhY2soKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcblxuICAgIC8vIEFncmVnYSBlbCBldmVudG8gY2xpY2sgYWwgYm90w7NuICdObycgcGFyYSBzaW1wbGVtZW50ZSBjZXJyYXIgZWwgcG9wdXBcbiAgICB0aGlzLl9ub0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG59XG4iLCJcbmNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZENhcmQoZGF0YSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRMaWtlKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlbW92ZUxpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgdXBkYXRlVXNlckluZm8oZGF0YSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIHVwZGF0ZUF2YXRhcihkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxufVxuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL3dlYl9lc18xMVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCJkOWNlZjgzNy1kMjliLTQyNmEtOGQ1OC04NjM1ZGRmZjRkM2ZcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBhcGk7IiwiaW1wb3J0IFwiLi9wYWdlcy9pbmRleC5jc3NcIjtcblxuaW1wb3J0IENhcmQgZnJvbSBcIi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFBvcHVwIGZyb20gXCIuL2NvbXBvbmVudHMvUG9wdXAuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XG5pbXBvcnQgYXBpIGZyb20gXCIuL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5cbmNvbnN0IHBvcHVwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwb3B1cFwiKTtcbmNvbnN0IG5hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xuY29uc3Qgcm9sZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3JvbGVcIik7XG5jb25zdCBlZGl0QnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlZGl0QnV0dG9uXCIpO1xuY29uc3QgYWRkQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhZGRCdXR0b25cIik7XG5jb25zdCBjbG9zZUVkaXRCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNsb3NlRWRpdEJ1dHRvblwiKTtcbmNvbnN0IHNhdmVFZGl0QnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzYXZlRWRpdEJ1dHRvblwiKTtcbmNvbnN0IGNsb3NlQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2xvc2VDYXJkQnV0dG9uXCIpO1xuY29uc3Qgc2F2ZUNhcmRCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNhdmVDYXJkQnV0dG9uXCIpO1xuY29uc3QgZWxlbWVudHNDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzXCIpO1xuY29uc3QgYXZhdGFyTm9kZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xuXG5jb25zdCBjb25maWdGb3JtID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLmZvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIuZm9ybV9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLmZvcm1fX3N1Ym1pdFwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImZvcm1fX3N1Ym1pdF9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcImZvcm1fX2Vycm9yX3Zpc2libGVcIixcbn07XG5cblxuXG5sZXQgc2VjdGlvbiA9IG51bGw7XG5sZXQgY3VycmVudFVzZXIgPSBudWxsO1xubGV0IGluaXRpYWxDYXJkcyA9IG51bGw7XG5cbmFwaVxuICAuZ2V0VXNlckluZm8oKVxuICAudGhlbigodXNlcikgPT4ge1xuICAgIGN1cnJlbnRVc2VyID0gdXNlcjtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyKTtcbiAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHVzZXIuYXZhdGFyKTtcbiAgICByZXR1cm4gYXBpLmdldEluaXRpYWxDYXJkcygpO1xuICB9KVxuICAudGhlbigoY2FyZHMpID0+IHtcbiAgICBpbml0aWFsQ2FyZHMgPSBjYXJkcztcbiAgICAvLyBDcmVhciBpbnN0YW5jaWEgZGUgbGEgY2xhc2UgU2VjdGlvblxuICAgIHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAgICAgIHtcbiAgICAgICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcbiAgICAgICAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XG4gICAgICAgICAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuICAgICAgICAgICAgaXRlbSxcbiAgICAgICAgICAgIFwiLnRlbXBsYXRlXCIsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGhhbmRsZUNhcmRDbGljazogc2hvd0ltYWdlUG9wdXAsXG4gICAgICAgICAgICAgIGhhbmRsZXJEZWxldGVDYXJkOiAoY2FyZEVsZW1lbnQsIF9pZCkgPT4ge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRDYXJkID0geyBjYXJkRWxlbWVudCwgX2lkIH07XG4gICAgICAgICAgICAgICAgY29uZmlybVBvcHVwLm9wZW4oKTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgaGFuZGxlckFkZExpa2U6IChjYXJkSWQpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXBpLmFkZExpa2UoY2FyZElkKTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgaGFuZGxlclJlbW92ZUxpa2U6IChjYXJkSWQpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXBpLnJlbW92ZUxpa2UoY2FyZElkKTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjdXJyZW50VXNlclxuICAgICAgICAgICk7XG4gICAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xuICAgICAgICAgIHNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgXCIuZWxlbWVudHNcIlxuICAgICk7XG4gICAgc2VjdGlvbi5yZW5kZXJlckl0ZW1zKCk7XG4gIH0pO1xuXG5mdW5jdGlvbiBzaG93SW1hZ2VQb3B1cChuYW1lLCBsaW5rKSB7XG4gIHBvcHVwV2l0aEltYWdlLm9wZW4obGluaywgbmFtZSk7XG59XG5cbi8vIENyZWFyIGluc3RhbmNpYSBkZSBsYSBjbGFzZSBGb3JtVmFsaWRhdG9yIHBhcmEgY2FkYSBmb3JtdWxhcmlvXG5jb25zdCBlZGl0UHJvZmlsZUZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZvcm0tcHJvZmlsZVwiKTtcbmNvbnN0IG5ld0NhcmRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90YXJqZXRhIGZvcm1cIik7XG5jb25zdCBhdmF0YXJGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9hdmF0YXIgZm9ybVwiKTtcblxuY29uc3QgZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnRm9ybSwgZWRpdFByb2ZpbGVGb3JtKTtcblxuY29uc3QgbmV3Q2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWdGb3JtLCBuZXdDYXJkRm9ybSk7XG5cbmNvbnN0IG5ld0F2YXRhckZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWdGb3JtLCBhdmF0YXJGb3JtKTtcblxuZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbm5ld0NhcmRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbm5ld0F2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG4vLyBDcmVhciBpbnN0YW5jaWEgZGUgbGEgY2xhc2UgUG9wdXBcbmNvbnN0IHBvcHVwSW5zdGFuY2UgPSBuZXcgUG9wdXAoXCIucG9wdXBcIik7XG5wb3B1cEluc3RhbmNlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIEFicmlyIGVsIHBvcHVwXG5wb3B1cEluc3RhbmNlLm9wZW4oKTtcblxuLy8gQ2VycmFyIGVsIHBvcHVwXG5wb3B1cEluc3RhbmNlLmNsb3NlKCk7XG5cbi8vIENyZWFyIGluc3RhbmNpYSBkZSBsYSBjbGFzZSBQb3B1cFdpdGhJbWFnZVxuY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIuaW1hZ2UtcG9wdXBcIik7XG5wb3B1cFdpdGhJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBDcmVhciBpbnN0YW5jaWEgZGUgbGEgY2xhc2UgUG9wdXBXaXRoRm9ybVxuY29uc3QgcG9wdXBQcm9maWxlID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIucG9wdXBcIiwgKHsgbmFtZSwgYWJvdXQgfSkgPT4ge1xuICAvLyBMw7NnaWNhIHBhcmEgbWFuZWphciBlbCBlbnbDrW8gZGVsIGZvcm11bGFyaW9cbiAgcmV0dXJuIGFwaS51cGRhdGVVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pLnRoZW4oKGRhdGEpID0+IHtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pO1xuICB9KTtcbn0pO1xucG9wdXBQcm9maWxlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHBvcHVwVGFyamV0YSA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3RhcmpldGFcIiwgKHsgdGl0bGUsIHVybCB9KSA9PiB7XG4gIHJldHVybiBhcGkuYWRkQ2FyZCh7IG5hbWU6IHRpdGxlLCBsaW5rOiB1cmwgfSkudGhlbigoZGF0YSkgPT4ge1xuICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICAgIGRhdGEsXG4gICAgICBcIi50ZW1wbGF0ZVwiLFxuICAgICAge1xuICAgICAgICBoYW5kbGVDYXJkQ2xpY2s6IHNob3dJbWFnZVBvcHVwLFxuICAgICAgICBoYW5kbGVyRGVsZXRlQ2FyZDogKGNhcmRFbGVtZW50LCBfaWQpID0+IHtcbiAgICAgICAgICBjdXJyZW50Q2FyZCA9IHsgY2FyZEVsZW1lbnQsIF9pZCB9O1xuICAgICAgICAgIGNvbmZpcm1Qb3B1cC5vcGVuKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGhhbmRsZXJBZGRMaWtlOiAoY2FyZElkKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGFwaS5hZGRMaWtlKGNhcmRJZCk7XG4gICAgICAgIH0sXG4gICAgICAgIGhhbmRsZXJSZW1vdmVMaWtlOiAoY2FyZElkKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGFwaS5yZW1vdmVMaWtlKGNhcmRJZCk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgY3VycmVudFVzZXJcbiAgICApO1xuICAgIGNvbnN0IG5ld0NhcmRFbGVtZW50ID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcbiAgICBlbGVtZW50c0NvbnRhaW5lci5wcmVwZW5kKG5ld0NhcmRFbGVtZW50KTtcbiAgfSk7XG59KTtcbnBvcHVwVGFyamV0YS5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBDcmVhciBpbnN0YW5jaWEgZGUgbGEgY2xhc2UgVXNlckluZm9cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX19uYW1lXCIsXG4gIHJvbGVTZWxlY3RvcjogXCIucHJvZmlsZV9fcm9sZVwiLFxuICBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9fYXZhdGFyLWltYWdlXCIsXG59KTtcblxuYWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIHRpdGxlSW5wdXQudmFsdWUgPSBcIlwiO1xuICB1cmxJbnB1dC52YWx1ZSA9IFwiXCI7XG4gIHBvcHVwVGFyamV0YS5vcGVuKCk7XG59KTtcblxuZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBuYW1lSW5wdXQudmFsdWUgPSBuYW1lRWxlbWVudC50ZXh0Q29udGVudDtcbiAgYWJvdXRNZUlucHV0LnZhbHVlID0gcm9sZUVsZW1lbnQudGV4dENvbnRlbnQ7XG4gIHBvcHVwUHJvZmlsZS5vcGVuKCk7XG59KTtcblxubGV0IGN1cnJlbnRDYXJkID0gbnVsbDtcbi8vIENyZWFyIGluc3RhbmNpYSBkZSBsYSBjbGFzZSBQb3B1cFdpdGhDb25maXJtYXRpb25cbmNvbnN0IGNvbmZpcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oXCIjY29uZmlybVBvcHVwXCIsICgpID0+IHtcbiAgLy8gQXF1w60gYWdyZWdhcsOtYXMgZWwgY8OzZGlnbyBwYXJhIGVsaW1pbmFyIGxhIHRhcmpldGFcbiAgaWYgKGN1cnJlbnRDYXJkKSB7XG4gICAgYXBpLmRlbGV0ZUNhcmQoY3VycmVudENhcmQuX2lkKS50aGVuKCgpID0+IHtcbiAgICAgIGN1cnJlbnRDYXJkLmNhcmRFbGVtZW50LnJlbW92ZSgpO1xuICAgICAgY29uc29sZS5sb2coXCJUYXJqZXRhIGVsaW1pbmFkYVwiKTtcbiAgICB9KTtcbiAgfVxufSk7XG5cbmNvbmZpcm1Qb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBBZ3JlZ2FyIGVsIGV2ZW50IGxpc3RlbmVyIGFsIMOtY29ubyBkZSBsYSBwYXBlbGVyYVxuZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5lbGVtZW50X190cmFzaFwiKS5mb3JFYWNoKCh0cmFzaEljb24pID0+IHtcbiAgdHJhc2hJY29uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgY29uZmlybVBvcHVwLm9wZW4oKTtcbiAgfSk7XG59KTtcblxuY29uc3QgcG9wdXBBdmF0YXIgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wb3B1cF9hdmF0YXJcIiwgKHsgYXZhdGFyIH0pID0+IHtcbiAgcmV0dXJuIGFwaS51cGRhdGVBdmF0YXIoeyBhdmF0YXIgfSkudGhlbigoZGF0YSkgPT4ge1xuICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIoZGF0YS5hdmF0YXIpO1xuICB9KTtcbn0pO1xuXG5wb3B1cEF2YXRhci5zZXRFdmVudExpc3RlbmVycygpO1xuXG5hdmF0YXJOb2RlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIHBvcHVwQXZhdGFyLm9wZW4oKTtcbn0pO1xuIl0sIm5hbWVzIjpbIkNhcmQiLCJkYXRhIiwidGVtcGxhdGVTZWxlY3RvciIsIl9yZWYiLCJjdXJyZW50VXNlciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZXJEZWxldGVDYXJkIiwiaGFuZGxlckFkZExpa2UiLCJoYW5kbGVyUmVtb3ZlTGlrZSIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfbGlrZXMiLCJsaWtlcyIsIl9pZCIsIl9vd25lciIsIm93bmVyIiwiX2N1cnJlbnRVc2VyIiwiX3RlbXBsYXRlU2VsZWN0b3IiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZXJEZWxldGVDYXJkIiwiX2hhbmRsZXJBZGRMaWtlIiwiX2hhbmRsZXJSZW1vdmVMaWtlIiwia2V5IiwidmFsdWUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZEVsZW1lbnQiLCJfdGhpcyIsInRyYXNoSWNvbiIsImxpa2VCdXR0b24iLCJpbWFnZU5vZGUiLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhc0xpa2VPd25lciIsInRoZW4iLCJjYXJkIiwidGV4dENvbnRlbnQiLCJsZW5ndGgiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJfdGhpczIiLCJzb21lIiwibGlrZSIsIl9lbGVtZW50IiwiX2dldFRlbXBsYXRlIiwic3JjIiwiYWx0IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2lzTWUiLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsIl9zZXR0aW5ncyIsIl9mb3JtRWxlbWVudCIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImVycm9yRWxlbWVudCIsImNvbmNhdCIsImlkIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImlzRm9ybVZhbGlkIiwiX2lucHV0TGlzdCIsImV2ZXJ5IiwiaXNBbnlGaWVsZEZpbGxlZCIsInRyaW0iLCJzdWJtaXRCdXR0b24iLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJkaXNhYmxlZCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvbiIsImZvckVhY2giLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiY29udGFpbmVyIiwiaXRlbSIsImVsZW1lbnQiLCJhcHBlbmRDaGlsZCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsImV2ZW50IiwiY2xvc2UiLCJfcG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhJbWFnZSIsIl9Qb3B1cCIsIl9jYWxsU3VwZXIiLCJfcG9wdXBJbWFnZSIsIl9wb3B1cFRpdGxlIiwiX2luaGVyaXRzIiwiaW1hZ2VTcmMiLCJpbWFnZUFsdCIsIl9nZXQiLCJfZ2V0UHJvdG90eXBlT2YiLCJwcm90b3R5cGUiLCJjYWxsIiwic3R5bGUiLCJkaXNwbGF5IiwiUG9wdXBXaXRoRm9ybSIsInN1Ym1pdENhbGxiYWNrIiwiX3N1Ym1pdENhbGxiYWNrIiwiX2Zvcm0iLCJmb3JtVmFsdWVzIiwiaW5wdXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJmaW5hbGx5IiwicmVzZXQiLCJVc2VySW5mbyIsIm5hbWVTZWxlY3RvciIsInJvbGVTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX3JvbGVFbGVtZW50IiwiX2F2YXRhckVsZW1lbnQiLCJyb2xlIiwiX3JlZjIiLCJhYm91dCIsImF2YXRhciIsIlBvcHVwV2l0aENvbmZpcm1hdGlvbiIsImNvbmZpcm1DYWxsYmFjayIsIl9jb25maXJtQ2FsbGJhY2siLCJfeWVzQnV0dG9uIiwiX25vQnV0dG9uIiwiQXBpIiwib3B0aW9ucyIsIl9iYXNlVXJsIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsImZldGNoIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiY2FyZElkIiwiYXV0aG9yaXphdGlvbiIsIm5hbWVFbGVtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJyb2xlRWxlbWVudCIsImVkaXRCdXR0b24iLCJhZGRCdXR0b24iLCJlbGVtZW50c0NvbnRhaW5lciIsImF2YXRhck5vZGUiLCJjb25maWdGb3JtIiwiZm9ybVNlbGVjdG9yIiwic2VjdGlvbiIsInNob3dJbWFnZVBvcHVwIiwicG9wdXBXaXRoSW1hZ2UiLCJvcGVuIiwiYXBpIiwiZ2V0VXNlckluZm8iLCJ1c2VyIiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsInNldFVzZXJBdmF0YXIiLCJnZXRJbml0aWFsQ2FyZHMiLCJjYXJkcyIsImN1cnJlbnRDYXJkIiwiY29uZmlybVBvcHVwIiwiYWRkTGlrZSIsInJlbW92ZUxpa2UiLCJnZW5lcmF0ZUNhcmQiLCJhZGRJdGVtIiwicmVuZGVyZXJJdGVtcyIsImVkaXRQcm9maWxlRm9ybSIsIm5ld0NhcmRGb3JtIiwiYXZhdGFyRm9ybSIsImVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciIsIm5ld0NhcmRGb3JtVmFsaWRhdG9yIiwibmV3QXZhdGFyRm9ybVZhbGlkYXRvciIsImVuYWJsZVZhbGlkYXRpb24iLCJwb3B1cEluc3RhbmNlIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJwb3B1cFByb2ZpbGUiLCJ1cGRhdGVVc2VySW5mbyIsInBvcHVwVGFyamV0YSIsInRpdGxlIiwidXJsIiwiYWRkQ2FyZCIsIm5ld0NhcmRFbGVtZW50IiwicHJlcGVuZCIsInRpdGxlSW5wdXQiLCJ1cmxJbnB1dCIsIm5hbWVJbnB1dCIsImFib3V0TWVJbnB1dCIsImRlbGV0ZUNhcmQiLCJjb25zb2xlIiwibG9nIiwicG9wdXBBdmF0YXIiLCJfcmVmMyIsInVwZGF0ZUF2YXRhciJdLCJzb3VyY2VSb290IjoiIn0=